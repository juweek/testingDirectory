// https://github.com/akngs/d3-boxplot v1.0.0 Copyright 2019-2021 Alan Kang
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3-array"),require("d3-scale")):"function"==typeof define&&define.amd?define(["exports","d3-array","d3-scale"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).d3=t.d3||{},t.d3,t.d3)}(this,(function(t,e,a){"use strict";const r="dot",n="tick";t.boxplot=function(){let t,e=!1,o=a.scaleLinear(),i=20,l=20,s=!0,c=r,d=.8,p=.2;function u(a){const u=e?"y":"x",f=e?"x":"y",m=e?"width":"height",h=e?(t,e)=>[e,t]:(t,e)=>[t,e],$=o.range()[0]>o.range()[1],y={};y[r]={nodeName:"circle",enter:function(t){t.attr("fill","currentColor").attr("stroke","none").attr("opacity",0).attr("r",0).attr(`c${u}`,(t=>o(t.value))).attr(`c${f}`,v)},update:function(t){t.attr("opacity",d).attr("r",(t=>t.farout?1.5*k:k)).attr(`c${u}`,(t=>o(t.value))).attr(`c${f}`,v)},exit:function(t){t.attr("opacity",0).attr("r",0)}},y[n]={nodeName:"line",enter:function(t){t.attr("stroke","currentColor").attr("opacity",0).attr(`${u}1`,(t=>o(t.value))).attr(`${u}2`,(t=>o(t.value))).attr(`${f}1`,0).attr(`${f}2`,0)},update:function(t){t.attr("opacity",d).attr(`${u}1`,(t=>o(t.value))).attr(`${u}2`,(t=>o(t.value))).attr(`${f}1`,Math.min(-2,-.25*l)).attr(`${f}2`,Math.max(2,.25*l))},exit:function(t){t.attr("opacity",0).attr(`${f}1`,0).attr(`${f}2`,0)}};const g=y[c],x=a.selection?a.selection():a,b=t=>`M${h(o(t.start),-.5*l)} l${h(0,l)} m${h(0,-.5*l)} L${h(o(t.end),0)}`,v=0===p?0:(t,e)=>.5*Math.sin(1e5*(e+t.value))*(t.farout?0:t.outlier?.5:1)*p*i,k=Math.max(1.5,.5*Math.sqrt(i));let w=x.select("g.whisker");w.empty()&&(w=x.append("g").attr("class","whisker").attr("transform",`translate(${h(0,.5*i)})`));let M=x.select("g.box");M.empty()&&(M=x.append("g").attr("class","box").attr("transform",`translate(${h(0,.5*i)})`));let N=x.select("g.point");N.empty()&&(N=x.append("g").attr("class","point").attr("transform",`translate(${h(0,.5*i)})`));let q=w.selectAll("path").data((t=>t.whiskers));q=q.enter().append("path").attr("fill","none").attr("stroke","currentColor").attr("opacity",0).attr("d",b).merge(q);let A=M.selectAll("line").data((t=>t.boxes));A=A.enter().append("line").attr("stroke","currentColor").attr("stroke-width",l).attr("opacity",0).attr(`${u}1`,((t,e)=>o(t.start)+(0===e?0:.5)*($?-1:1))).attr(`${u}2`,((t,e)=>o(t.end)-(0===e?.5:0)*($?-1:1))).attr(`${f}1`,0).attr(`${f}2`,0).attr(m,l).merge(A),N.selectAll(".point").filter((function(){return this.nodeName!==g.nodeName})).remove();let C=N.selectAll(".point").data((t=>s?t.points:t.points.filter((t=>t.outlier))),t?e=>t(e.datum):void 0),j=C.exit();return C=C.enter().append(g.nodeName).attr("class","point").call(g.enter).merge(C).classed("outlier",(t=>t.outlier)).classed("farout",(t=>t.farout)),a!==x&&(w=w.transition(a),M=M.transition(a),N=N.transition(a),q=q.transition(a),A=A.transition(a),C=C.transition(a),j=j.transition(a)),w.attr("transform",`translate(${h(0,.5*i)})`),M.attr("transform",`translate(${h(0,.5*i)})`),N.attr("transform",`translate(${h(0,.5*i)})`),q.attr("opacity",d).attr("d",b),A.attr("opacity",d).attr("stroke-width",l).attr(`${u}1`,((t,e)=>o(t.start)+(0===e?0:.5)*($?-1:1))).attr(`${u}2`,((t,e)=>o(t.end)-(0===e?.5:0)*($?-1:1))).attr(`${f}1`,0).attr(`${f}2`,0),C.call(g.update),j.call(g.exit).remove(),this}return u.vertical=(...t)=>t.length?(e=t[0],u):e,u.scale=(...t)=>t.length?(o=t[0],u):o,u.showInnerDots=(...t)=>t.length?(s=t[0],u):s,u.bandwidth=(...t)=>t.length?(i=t[0],u):i,u.boxwidth=(...t)=>t.length?(l=t[0],u):l,u.symbol=(...t)=>t.length?(c=t[0],u):c,u.opacity=(...t)=>t.length?(d=t[0],u):d,u.jitter=(...t)=>t.length?(p=t[0],u):p,u.key=(...e)=>e.length?(t=e[0],u):t,u},t.boxplotStats=function(t,a){const r=a?t.map(a):t,n=[0,.25,.5,.75,1].map((t=>e.quantile(r,t))),o=n[3]-n[1],i=1.5*o,l=[{start:n[1]-i-i,end:n[1]-i},{start:n[1]-i,end:n[1]},{start:n[1],end:n[3]},{start:n[3],end:n[3]+i},{start:n[3]+i,end:n[3]+i+i}],s=[{start:n[1],end:n[2]},{start:n[2],end:n[3]}],c=[{start:e.min(r.filter((t=>l[1].start<=t))),end:n[1]},{start:e.max(r.filter((t=>l[3].end>=t))),end:n[3]}],d=r.map(((e,a)=>({value:e,datum:t[a],outlier:e<l[1].start||l[3].end<e,farout:e<l[0].start||l[4].end<e})));return{fiveNums:n,iqr:o,step:i,fences:l,boxes:s,whiskers:c,points:d}},t.boxplotSymbolDot=r,t.boxplotSymbolTick=n,Object.defineProperty(t,"__esModule",{value:!0})}));
